% -*- coding: utf-8; -*-
\documentclass{article}

%% This helper document is part of QSoas, it's purpose is to make
%% the computations involved in some parts of the code more explicit
%% 
%% Copyright 2024 by CNRS/AMU

%% This program is free software; you can redistribute it and/or
%% modify it under the terms of the GNU General Public License as
%% published by the Free Software Foundation; either version 2 of the
%% License, or (at your option) any later version.

%% This program is distributed in the hope that it will be useful, but
%% WITHOUT ANY WARRANTY; without even the implied warranty of
%% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
%% General Public License for more details.

%% You should have received a copy of the GNU General Public License
%% along with this program.  If not, see
%% <http://www.gnu.org/licenses/>.

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage{amsmath}

\usepackage[svgnames]{xcolor}
\usepackage[colorlinks, urlcolor=blue, citecolor=DarkGreen,
linkcolor=blue]{hyperref}

\usepackage{graphicx}

\usepackage[a4paper,landscape=false,showframe=false,
margin=1.8cm]{geometry}

\usepackage[version=3]{mhchem}

\usepackage{siunitx}
\usepackage{booktabs}

\usepackage{mathpazo}
\usepackage[scaled]{helvet}
\usepackage{courier}

\usepackage{cite}
\usepackage{pifont}



%% A series of useful macros:
\newcommand{\dd}{\mathrm{d}}
\newcommand{\pa}[1]{\left(#1\right)}
\newcommand{\pab}[1]{\left[#1\right]}


\begin{document}

\begin{abstract}
  This document contains a number of computations underlying some of
  the algorithms used in the code of QSoas. It serves both as a helper
  to write the code and a justification of how it works. See also the
  file \texttt{tests/doc/computations.tex} for the pendant of this
  file for the tests.
\end{abstract}

\section{Convolutions}

Here are the computations for the way \texttt{QSoas} convolves a
\emph{dataset} $f$ with a \emph{function} $g$. The convolution product
is given by the following integral:
%
\begin{equation}
  (f*g)(t) = \int_{t' = -\infty}^{\infty} f(t') g(t-t')\:\dd t'
\end{equation}
%
Assuming that the data points of $f$ are uniformly spread over $n$
intervals of length $\Delta t$ starting at $t_0$ (this means $n+1$
data points), this integral can be rewritten this way:
%
\begin{equation}
  (f*g)(t) = \sum_{i = 0}^{n-1}
  \int_{t_0 + i \Delta t}^{t_0 + (i+1) \Delta t}
  f(t') g(t-t')\:\dd t'
\end{equation}
%
The convolution process will produce a \emph{dataset} with the same
number and position of points as $f$. For all points $i < n$, we have
therefore:
%
\begin{equation}
  (f*g)_i = (f*g)(t_0 + i\Delta i) = 
  \sum_{i = 0}^{n-1} \int_{t_0 + j \Delta t}^{t_0 + (j+1) \Delta t}
  f(t') g(t_0 + i\Delta t-t')\:\dd t'
\end{equation}
%
We'll look at the last point later.

\end{document}
